{"version":3,"sources":["components/MapBox/images/express.png","components/MapBox/MapBox.js","components/MapBox/images/bus.png","components/MapBox/images/airport.png","components/MapBox/images/close.png","components/StationInfo/StationInfo.js","components/RouteInfo/RouteInfo.js","components/Chart/Chart.js","components/EntersMap/EntersMap.js","components/FullModal/FullModal.js","components/FormInclusive/FormInclusive.js","components/SearchBox/SearchBox.js","components/SearchBox/images/switch.png","App.js","index.js"],"names":["state","width","height","latitude","longitude","zoom","MapBox","params","refMap","useRef","setShowStationInfo","stationsData","linesData","pathData","pathStations","selectedStation1","selectedStation2","setSelectedStation1","setSelectedStation2","riverData","boundaryData","airportPointsData","airportLinesData","airportData","metroPointsData","viewport","useState","viewportState","setViewport","isMapBoxReady","setIsMapBoxReady","setOpacity","value","current","getMap","setPaintProperty","addPointIcon","img","name","loadImage","error","image","hasImage","addImage","useEffect","features","length","className","ref","mapboxApiAccessToken","mapStyle","maxZoom","onLoad","event","expressImg","minZoom","onClick","targetLayer","console","log","layer","id","indexOf","onViewportChange","type","data","paint","layout","filter","linesNames","StationInfo","props","stationInfo","this","Modal","show","onHide","setShow","size","aria-labelledby","centered","Header","closeButton","Title","properties","line","style","color","Body","status","Row","Col","xs","Button","setShowFullModal","React","Component","RouteInfo","setPathData","routeTime","_","map","f","time","turf","featureCollection","options","scales","yAxes","ticks","beginAtZero","weeekDay","1","2","3","4","5","6","7","Chart","key","setKey","Tabs","activeKey","onSelect","k","day","tabData","labels","slice","datasets","label","rate","fill","backgroundColor","Tab","eventKey","weekday","title","Spinner","animation","EntersMap","stationCoords","JSON","parse","geo_coords","FullModal","href","target","wifiData","FormInclusive","Form","Group","as","controlId","Label","Control","placeholder","defaultValue","Check","variant","SearchBox","readOnly","temp1","Object","assign","temp2","src","localDB","require","remoteDB","App","showStationInfo","showFullModal","setStationsData","setLinesData","dbSyncStatus","setDBSyncStatus","isDataLoading","getIsDataLoading","setPathStations","setWifiData","setRiverData","setBoundaryData","setAirportPointsData","setAirportLinesData","setMetroPointsData","setAirportData","showInclusiveForm","setShowInclusiveForm","getDataFromLocalDB","get","then","geo","feature","geometry","wifi","PouchDB","replicate","from","err","response","info","catch","e","$","removeClass","addClass","path","precision","findPath","lineOverlap","default","a","lineString","coordinates","tolerance","filteredPathStations","buffer","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b76bf3fc.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/express.7af62329.png\";","import React, { useRef, useState, useEffect } from \"react\";\nimport ReactMapGL, { Source, Layer } from 'react-map-gl';\nimport $ from 'jquery';\nimport turf from \"turf\";\nimport busImg from './images/bus.png';\nimport expressImg from './images/express.png';\nimport airportImg from './images/airport.png';\nimport closedImg from './images/close.png';\n\nconst state = {\n    viewport: {\n      width: '100%',\n      height: '100vh',\n      latitude: 55.721,\n      //mapStyle: 'mapbox://styles/doninpr/ckgwdst571ils19l9lnybwdta/draft', //streets\n      longitude: 37.6003,\n      zoom: 9.5\n    }\n  };\n\nfunction MapBox(params) {\n\n  const refMap = useRef(null);\n  \n  const {\n    setShowStationInfo,\n    stationsData,\n    linesData,\n    pathData,\n    selectedStation1,\n    selectedStation2,\n    setSelectedStation1,\n    setSelectedStation2,\n    pathStations,\n    riverData,\n    boundaryData,\n    airportPointsData,\n    airportLinesData,\n    airportData,\n    metroPointsData\n  } = params;\n\n  const viewport = {\n    ...state.viewport,\n  };\n\n  const [viewportState, setViewport] = useState(viewport);\n  const [isMapBoxReady, setIsMapBoxReady] = useState(false);\n\n  const _onLoad = (event) => {\n    addPointIcon(busImg, 'autobus');\n    addPointIcon(expressImg, 'express');\n    addPointIcon(airportImg, 'airport');\n    addPointIcon(closedImg, 'closed');\n    setIsMapBoxReady(true);\n  }\n\n  const _onClick = (event) => {\n    const targetLayer = event.features[0];\n    const targetLayer2 = event.features[1];\n    console.log(targetLayer);\n\n    if(targetLayer && targetLayer.layer.id.indexOf(\"stations-layer\") !== -1){\n      setShowStationInfo(targetLayer);\n    }\n  }\n\n  const setOpacity = value => {\n    if(refMap.current){\n      refMap.current.getMap().setPaintProperty(\n        'lines-layer',\n        'line-opacity',\n        value\n      );\n      refMap.current.getMap().setPaintProperty(\n        'stations-layer_point',\n        'circle-opacity',\n        value\n      );\n      refMap.current.getMap().setPaintProperty(\n        'stations-layer_center',\n        'circle-opacity',\n        value\n      );\n      refMap.current.getMap().setPaintProperty(\n        'stations-layer_name',\n        'text-opacity',\n        value\n      );\n    }\n  };\n\n  const addPointIcon = (img, name) => {\n    refMap.current.getMap().loadImage(img, function(error, image) {\n      if (error) throw error;\n      if (!refMap.current.getMap().hasImage(name)) refMap.current.getMap().addImage(name, image);\n    });\n  }\n\n  \n  useEffect(() => {\n    if(isMapBoxReady){\n      if(pathData.features.length > 0){\n        setOpacity(0.2);\n      } else {\n        setOpacity(1);\n      }\n    }\n  }, [pathData]);\n\n  return (\n    <ReactMapGL\n      className={'mapbox'}\n      ref={refMap}\n      mapboxApiAccessToken = {\"pk.eyJ1IjoiZG9uaW5wciIsImEiOiJjaXVxM3E4OTkwMDAwMm9wczBnYjR4bnJoIn0.7drt92qBRl7KJ6dLg0mrww\"}\n      mapStyle={'mapbox://styles/doninpr/ckgxo0l6e3rxb19qjcm2gy0bf/draft'}\n      {...viewportState}\n      maxZoom={13}\n      onLoad={_onLoad}\n      minZoom={8}\n      onClick={_onClick}\n      onViewportChange={(viewport) => setViewport(viewport)}\n    >\n      <Source id=\"boundary-data\" type=\"geojson\" data={boundaryData}>\n        <Layer\n          id=\"boundary-layer\"\n          type=\"fill\"\n          paint={{\n            'fill-color': '#fff',\n          }}\n        />\n      </Source>\n      <Source id=\"river-data\" type=\"geojson\" data={riverData}>\n        <Layer\n          id=\"river-layer\"\n          type=\"fill\"\n          paint={{\n            'fill-color': '#e0f3fa',\n          }}\n        />\n      </Source>\n      <Source id=\"airport-lines-data\" type=\"geojson\" data={airportLinesData}>\n        <Layer\n          id=\"airport-lines-layer\"\n          type=\"line\"\n          paint={{\n            'line-color': [\"match\", ['get', 'type'], \"аэроэкспресс\", '#e196a8', '#aedbef'],\n            'line-width': 1,\n          }}\n        />\n        <Layer\n          id=\"airport-lines-symbol\"\n          type=\"symbol\"\n          paint={{\n          }}\n          layout={{\n            'symbol-placement': 'line',\n            'text-size': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                3,\n                13,\n                14\n              ],\n            'text-offset': [0, 1],\n            'text-max-angle': 0,\n            'symbol-spacing': 400,\n            'text-field': ['get', 'name']\n          }}\n        />\n      </Source>\n      <Source id=\"airport-points-data\" type=\"geojson\" data={airportPointsData}>\n        <Layer\n          id=\"airport-points-layer\"\n          type=\"symbol\"\n          layout={{\n            'icon-image': [\"match\", ['get', 'type'], \"аэроэкспресс\", 'express', 'autobus'],\n            'icon-size': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                0.3,\n                13,\n                1\n              ],\n          }}\n        />\n      </Source>\n      <Source id=\"airports-data\" type=\"geojson\" data={airportData}>\n        <Layer\n          id=\"airports-layer\"\n          type=\"symbol\"\n          layout={{\n            'icon-image': 'airport',\n            'icon-size': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                0.4,\n                13,\n                1.2\n              ],\n            'text-field': ['get', 'name'],\n            'text-size': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                4,\n                13,\n                14\n              ],\n            'text-allow-overlap': true,\n            'text-font': [\n              \"Moscow Sans Regular\",\n              \"Open Sans Regular\"\n            ],\n            'text-anchor': 'left',\n            'text-justify': 'left',\n            'text-offset': [1, 0]\n          }}\n        />\n      </Source>\n      <Source id=\"lines-data\" type=\"geojson\" data={linesData}>\n        <Layer\n          id=\"lines-layer\"\n          type=\"line\"\n          paint={{\n            'line-color': ['get', 'color'],\n            'line-gap-width': [\"match\", ['get', 'line_type'], \"мцк\", 1, \"мцд\", 1, 0],\n            'line-width': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                [\"match\", ['get', 'line_type'], \"мцк\", 1, \"мцд\", 1, 2],\n                13,\n                [\"match\", ['get', 'line_type'], \"мцк\", 4, \"мцд\", 4, 8]\n              ],\n          }}\n        />\n      </Source>\n      <Source id=\"path-data\" type=\"geojson\" data={pathData}>\n        <Layer\n          id=\"path-layer\"\n          type=\"line\"\n          paint={{\n            'line-color': ['get', 'color'],\n            'line-gap-width': [\"match\", ['get', 'line_type'], \"мцк\", 1, \"мцд\", 1, 0],\n            'line-width': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                [\"match\", ['get', 'line_type'], \"мцк\", 1, \"мцд\", 1, 2],\n                13,\n                [\"match\", ['get', 'line_type'], \"мцк\", 4, \"мцд\", 4, 8]\n              ],\n          }}\n        />\n      </Source>\n      <Source id=\"metro-data\" type=\"geojson\" data={metroPointsData}>\n        <Layer\n          id=\"metro-layer\"\n          type=\"circle\"\n          paint={{\n            'circle-radius': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                3,\n                13,\n                15\n              ],\n            'circle-color': ['get', 'color']\n          }}\n        />\n        <Layer\n          id=\"metro-layer_name\"\n          type=\"symbol\"\n          paint={{\n            'text-halo-color': '#fff',\n            'text-color': '#fff',\n            'text-halo-width': 0.25,\n          }}\n          layout={{\n            'text-field': ['get', 'name'],\n            'text-allow-overlap': true,\n            'text-font': [\n              \"Moscow Sans Regular\",\n              \"Open Sans Regular\"\n            ],\n            'text-size': [\n              \"interpolate\",\n              [\"linear\"],\n              [\"zoom\"],\n              8,\n              3,\n              13,\n              15\n            ],\n          }}\n        />\n      </Source>\n      <Source id=\"stations-data\" type=\"geojson\" data={stationsData}>\n        <Layer\n          id=\"stations-layer_point\"\n          type=\"circle\"\n          paint={{\n            'circle-radius': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                3,\n                13,\n                9\n              ],\n            'circle-color': ['get', 'color']\n          }}\n        />\n        <Layer\n          id=\"stations-layer_center\"\n          type=\"circle\"\n          paint={{\n            'circle-radius': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                1,\n                13,\n                5\n              ],\n            'circle-color': '#fff'\n          }}\n        />\n        <Layer\n          id=\"stations-layer_status\"\n          type=\"symbol\"\n          filter={[\n            \"all\",\n            [\"!=\", [\"get\", \"status\"], \"open\"]\n          ]}\n          layout={{\n            'icon-size': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                0.2,\n                13,\n                1\n              ],\n            'icon-image': 'closed',\n            'icon-allow-overlap': true,\n          }}\n        />\n        <Layer\n          id=\"stations-layer_name\"\n          type=\"symbol\"\n          paint={{\n            'text-halo-color': '#fff',\n            'text-halo-width': 1,\n          }}\n          layout={{\n            'text-field': ['get', 'name'],\n            'text-anchor': 'left',\n            'text-offset': [0.7, 0],\n            'text-font': [\n              \"Moscow Sans Regular\",\n              \"Open Sans Regular\"\n            ],\n            'text-size': [\n              \"interpolate\",\n              [\"linear\"],\n              [\"zoom\"],\n              8,\n              3,\n              13,\n              16\n            ],\n          }}\n        />\n      </Source>\n      <Source id=\"path-stations-data\" type=\"geojson\" data={pathStations}>\n        <Layer\n          id=\"stations-layer_point--path\"\n          type=\"circle\"\n          paint={{\n            'circle-radius': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                3,\n                13,\n                9\n              ],\n            'circle-color': ['get', 'color']\n          }}\n        />\n        <Layer\n          id=\"stations-layer_center--path\"\n          type=\"circle\"\n          paint={{\n            'circle-radius': [\n                \"interpolate\",\n                [\"linear\"],\n                [\"zoom\"],\n                8,\n                1,\n                13,\n                5\n              ],\n            'circle-color': '#fff'\n          }}\n        />\n        <Layer\n          id=\"stations-layer_name--path\"\n          type=\"symbol\"\n          paint={{\n            'text-halo-color': '#fff',\n            'text-halo-width': 1,\n          }}\n          layout={{\n            'text-field': ['get', 'name'],\n            'text-anchor': 'left',\n            'text-offset': [0.7, 0],\n            'text-font': [\n              \"Moscow Sans Regular\",\n              \"Open Sans Regular\"\n            ],\n            'text-size': [\n              \"interpolate\",\n              [\"linear\"],\n              [\"zoom\"],\n              8,\n              3,\n              13,\n              16\n            ],\n          }}\n        />\n      </Source>\n    </ReactMapGL>\n  );\n}\n\nexport default MapBox;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAgVBMVEUAAABOrNtOrthPrdlOrthOrtlOrthOrthOrthPrddOr9hOrthOrtlOrthJtttOrthOrtdVqt1Qr99NrthOrthOrtlNr9hOrthOrthPrtlOrtlOr9dOrthOrthOrthPrthOrthOrthOrthOrdhOsdhOrtdNrdhRrtpNrNlOrtgAAADOmwptAAAAKXRSTlMAMd+fwlhVw6pnae+t8AfA1Q8Q1rfptfzj8Lq7/u69vL5oxIkNreopKBBaOcYAAAABYktHRACIBR1IAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH5AsBAiwR3mg6cgAAAJFJREFUGNNNzusSgiAQhuHPU2B46GSiokVqtfd/g7lE5vsDZp5h2AWCkNbCAEBEcbJzJYKiBSSl8O1JOlCZdGU5Q1Eejr8Xp3NZ4FJJrMnqilpvQdcQ+RaaeDnaP3RuimmlrzPfsf1geE1zU36PFHeGAdaDsDmDsg8HI20aF5jmSjf8ZaOf88SzXopivgX1b+ADrmIO7RWZFYUAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjAtMTEtMDFUMDI6NDQ6MTcrMDA6MDDAEhTeAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIwLTExLTAxVDAyOjQ0OjE3KzAwOjAwsU+sYgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAhQAAAIUB4uz/wQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAADeSURBVDiNtZIxCsJAEEXfxD6pBRsvICmt7PUAAS9g7y08geQksfcUnkB7QbAJ38IR12Q3guCHgcnf/z+b2TFJxGBmI+DonwtJbVQoKVrADJDXLKXLoqlPZIk+KfoJfw2YJvpPRIZXAHug5T3E1rmip++YK+AcGLt1BqpegF+xGTB2qwGmrx1aA7fg8ALUwDbgts5dAu7mXmrgBOyAOWCeXAbi0jlzzc49NUCe2MReQESTZ5KuySf6AknXoT2YJPpeSuxqG+Ae/MId2MS0r4F9wMwOPCfeOLUCxpKWXe0DD9fk64zXtw0AAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAABvAAAAbwHxotxDAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAADZQTFRF/////wAA5Bsb4Rsb4xoa4Rwc4xsb4Rsb4hsb4hsb4hsb4yIi4yYm8ZSU98DA98HB98LC////D8BLZgAAAAp0Uk5TAAEmcH+As7Xm9myQZpsAAABqSURBVBhXZY9JDgMhDASrbWDy/98OwfYcQhRF1LGl3gRgLiMrEhDIhgComYXQcL7ELOEXP+6QXcKUhaySutU7eIvAfQVMjQZyr7KIgqWXAeoiVwG5hWbU+yNsS0rbcoQetcewc/pxjv/7D9JkQzloZ2NlAAAAAElFTkSuQmCC\"","import React from \"react\";\nimport _ from \"lodash\";\nimport { Modal, Button, Row, Col } from 'react-bootstrap';\n\nconst linesNames = {\n  \"1\": \"Сокольническая\",\n  \"2\": \"Замоскворецкая\",\n  \"3\": \"Арбатско-Покровская\",\n  \"4\": \"Филевская\",\n  \"5\": \"Кольцевая\",\n  \"6\": \"Калужско-Рижская\",\n  \"7\": \"Таганско-Краснопресненская\",\n  \"8\": \"Калининско-Солнцевская\",\n  \"9\": \"Серпуховско-Тимирязевская\",\n  \"10\": \"Люблинско-Дмитровская\",\n  \"11A\": \"Каховская\",\n  \"12\": \"Бутовская\",\n  \"14\": \"Московское Центральное Кольцо\",\n  \"13\": \"Монорельс\",\n  \"D1\": \"Московские центральные диаметры\",\n  \"D2\": \"Московские центральные диаметры\",\n  \"15\": \"Некрасовская\",\n};\n\nclass StationInfo extends React.Component {\n  constructor(props) {\n    super(props);\n    this.props = props;\n  }\n\n  render() {\n    const stationInfo = this.props.stationInfo;\n    return (\n        <Modal\n          className={this.props.className ? this.props.className : \"modal-full\"}\n          show={!(stationInfo === false)}\n          onHide={() => this.props.setShow(false)}\n          size={this.props.size || \"lg\"}\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n        >\n          <Modal.Header closeButton>\n            <Modal.Title id=\"contained-modal-title-vcenter\">\n            {stationInfo.properties &&\n              <>\n                <div className=\"station-caption\">\n                  {linesNames[stationInfo.properties.line]}\n                </div>\n                <div className=\"station-header\">\n                  <span style={{ 'backgroundColor': stationInfo.properties.color }}>{stationInfo.properties.line}</span>\n                  {stationInfo.properties.name}\n                </div>\n              </>\n            }\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body className=\"station-body\">\n            {stationInfo && stationInfo.properties.status === 'open' &&\n              <Row>\n                <Col xs={6}>\n                  <Button onClick={() => {\n                    this.props.setSelectedStation1(stationInfo);\n                    this.props.setShow(false);\n                  }}>↑ Отсюда</Button>\n                </Col>\n                <Col xs={6}>\n                  <Button onClick={() => {\n                    this.props.setSelectedStation2(stationInfo);\n                    this.props.setShow(false);\n                  }}>↓ Сюда</Button>\n                </Col>\n              </Row>\n            }\n            {stationInfo && stationInfo.properties.status !== 'open' && \n              <Row>\n                <Col>\n                  <p>Станция временно закрыта.</p>\n                </Col>\n              </Row>\n            }\n            <Row>\n              <Col>\n                <Button onClick={() => {\n                  this.props.setShowFullModal(true);\n                }} className=\"button-info\">Информация о станции</Button>\n              </Col>\n            </Row>\n          </Modal.Body>\n        </Modal>\n    );\n  }\n}\n\n\n\nexport default StationInfo;","import React from \"react\";\nimport _ from \"lodash\";\nimport { Modal, Button, Row, Col } from 'react-bootstrap';\nimport turf from \"turf\";\n\nconst linesNames = {\n  \"1\": \"Сокольническая\",\n  \"2\": \"Замоскворецкая\",\n  \"3\": \"Арбатско-Покровская\",\n  \"4\": \"Филевская\",\n  \"5\": \"Кольцевая\",\n  \"6\": \"Калужско-Рижская\",\n  \"7\": \"Таганско-Краснопресненская\",\n  \"8\": \"Калининско-Солнцевская\",\n  \"9\": \"Серпуховско-Тимирязевская\",\n  \"10\": \"Люблинско-Дмитровская\",\n  \"11A\": \"Каховская\",\n  \"12\": \"Бутовская\",\n  \"14\": \"Московское Центральное Кольцо\",\n  \"13\": \"Монорельс\",\n  \"D1\": \"Московские центральные диаметры\",\n  \"D2\": \"Московские центральные диаметры\",\n  \"15\": \"Некрасовская\",\n};\n\nclass RouteInfo extends React.Component {\n  constructor(props) {\n    super(props);\n    this.props = props;\n  }\n\n  render() {\n    const {\n      selectedStation1,\n      selectedStation2,\n      pathData,\n      setPathData\n    } = this.props;\n\n    let routeTime = 0;\n\n    _.map(pathData.features, (f) => {\n      routeTime = routeTime + f.properties.time;\n    });\n\n    const stationInfo = this.props.stationInfo;\n    return (\n        <Modal\n          className={this.props.className ? this.props.className : \"modal-full\"}\n          show={pathData.features.length > 0}\n          onHide={() => setPathData(turf.featureCollection([]))}\n          size={this.props.size || \"lg\"}\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n        >\n          <Modal.Header closeButton>\n            <Modal.Title id=\"contained-modal-title-vcenter\">\n            {selectedStation1 && selectedStation2 &&\n              <Row className=\"route-header\">\n                <Col xs={6}>\n                  <div className=\"station-caption\">\n                    Откуда:\n                  </div>\n                  <div className=\"station-header\">\n                    <span style={{ 'backgroundColor': selectedStation1.properties.color }}>{selectedStation1.properties.line}</span>\n                    {selectedStation1.properties.name}\n                  </div>\n                </Col>\n                <Col xs={6}>\n                  <div className=\"station-caption\">\n                    Куда:\n                  </div>\n                  <div className=\"station-header\">\n                    <span style={{ 'backgroundColor': selectedStation2.properties.color }}>{selectedStation2.properties.line}</span>\n                    {selectedStation2.properties.name}\n                  </div>\n                </Col>\n              </Row>\n            }\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body className=\"station-body\">\n            <Row>\n              <Col xs={12}>\n                <p>Время в пути: <span>{routeTime} мин.</span></p>  \n              </Col>\n              <Col xs={12}>\n\n              </Col>\n            </Row>\n          </Modal.Body>\n        </Modal>\n    );\n  }\n}\n\n\n\nexport default RouteInfo;","import React, { useState } from 'react';\nimport { Line } from '@reactchartjs/react-chart.js';\nimport { Row, Col, Tab, Tabs, Spinner } from 'react-bootstrap';\nimport _ from 'lodash';\n\nconst data = {\n  labels: ['6ч', '7ч', '8ч', '9ч', '10ч', '11ч', '12ч', '13ч', '14ч', '15ч', '16ч', '17ч', '18ч', '19ч', '20ч', '21ч', '22ч', '23ч', '24ч', '1ч'],\n  datasets: [\n    {\n      label: 'уровень загруженности',\n      data: [10, 9, 6, 5, 6, 3, 7, 8, 9, 5, 3, 2, 6, 9, 10, 5, 6, 4, 3, 1],\n      fill: 'origin',\n      backgroundColor: 'rgb(255, 99, 132)',\n      borderColor: 'rgba(255, 99, 132, 0.2)',\n    },\n  ],\n}\n\nconst options = {\n  scales: {\n    yAxes: [\n      {\n        ticks: {\n          beginAtZero: true,\n        },\n      },\n    ],\n  },\n}\n\nconst weeekDay = {\n  1: 'пн',\n  2: 'вт',\n  3: 'ср',\n  4: 'чт',\n  5: 'пт',\n  6: 'сб',\n  7: 'вс',\n};\n\nconst Chart = ({ data }) => {\n  const [key, setKey] = useState('пн');\n\n\n  if(!data){\n    return (\n      <Spinner animation=\"border\" />\n    );\n  }\n\n  return (\n    <div className=\"chart-block\">\n      <Row>\n        <Col>\n          <p>Загруженность станции в течении дня</p>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <Tabs\n            activeKey={key}\n            onSelect={(k) => setKey(k)}\n          >\n            {_.map(data, (day, key) => {\n              const tabData = {\n                labels: _.map(day.time.slice(6), (time) => { return time+\"ч\"; }),\n                datasets: [\n                  {\n                    label: 'уровень загруженности',\n                    data: _.map(day.rate.slice(6), (rate) => { return rate; }),\n                    fill: 'origin',\n                    backgroundColor: '#d02a31',\n                  },\n                ],\n              }\n              return (\n                <Tab key={key} eventKey={weeekDay[day.weekday]} title={weeekDay[day.weekday]}>\n                  <Line data={tabData} options={options} />\n                </Tab>\n              );\n            })}\n          </Tabs>\n        </Col>\n      </Row>\n    </div>\n  );\n}\n\nexport default Chart;","import React, { useRef, useState, useEffect } from \"react\";\nimport ReactMapGL, { Source, Layer } from 'react-map-gl';\nimport $ from 'jquery';\nimport turf from \"turf\";\n\nconst state = {\n    viewport: {\n      width: '100%',\n      height: 300,\n      latitude: 55.721,\n      //mapStyle: 'mapbox://styles/doninpr/ckgwdst571ils19l9lnybwdta/draft', //streets\n      longitude: 37.6003,\n      zoom: 14\n    }\n  };\n\nfunction EntersMap(params) {\n\n  const {\n    stationInfo,\n  } = params;\n\n  const stationCoords = JSON.parse(stationInfo.properties.geo_coords);\n\n  const [viewportState, setViewport] = useState({\n    latitude: stationCoords[1],\n    longitude: stationCoords[0],\n  });\n\n  return (\n    <div className=\"enters-map\">\n      <div className=\"enters-map_title\">\n        <p>Выходы из метро</p>\n      </div>\n      <ReactMapGL\n        mapboxApiAccessToken = {\"pk.eyJ1IjoiZG9uaW5wciIsImEiOiJjaXVxM3E4OTkwMDAwMm9wczBnYjR4bnJoIn0.7drt92qBRl7KJ6dLg0mrww\"}\n        mapStyle={'mapbox://styles/doninpr/ckgwdst571ils19l9lnybwdta/draft'}\n        {...viewportState}\n        onViewportChange={(viewport) => setViewport(viewport)}\n        height={300}\n        width={'100%'}\n        minZoom={13}\n        maxZoom={18}\n      />\n    </div>\n  );\n}\n\nexport default EntersMap;","import React from \"react\";\nimport _ from \"lodash\";\nimport { Modal, Row, Col, Button } from 'react-bootstrap';\nimport Chart from \"../Chart/Chart\";\nimport EntersMap from \"../EntersMap/EntersMap\";\n\nconst linesNames = {\n  \"1\": \"Сокольническая\",\n  \"2\": \"Замоскворецкая\",\n  \"3\": \"Арбатско-Покровская\",\n  \"4\": \"Филевская\",\n  \"5\": \"Кольцевая\",\n  \"6\": \"Калужско-Рижская\",\n  \"7\": \"Таганско-Краснопресненская\",\n  \"8\": \"Калининско-Солнцевская\",\n  \"9\": \"Серпуховско-Тимирязевская\",\n  \"10\": \"Люблинско-Дмитровская\",\n  \"11A\": \"Каховская\",\n  \"12\": \"Бутовская\",\n  \"14\": \"Московское Центральное Кольцо\",\n  \"13\": \"Монорельс\",\n  \"D1\": \"Московские центральные диаметры\",\n  \"D2\": \"Московские центральные диаметры\",\n  \"15\": \"Некрасовская\",\n};\n\nclass FullModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.props = props;\n  }\n\n  render() {\n    const stationInfo = this.props.stationInfo;\n    return (\n        <Modal\n          className={\"modal-full\"}\n          show={this.props.show}\n          onHide={() => this.props.setShow(false)}\n          size={this.props.size || \"lg\"}\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n        >\n          <Modal.Header closeButton>\n            <Modal.Title id=\"contained-modal-title-vcenter\">\n              {stationInfo.properties &&\n                <>\n                  <div className=\"station-caption\">\n                    {linesNames[stationInfo.properties.line]}\n                  </div>\n                  <div className=\"station-header\">\n                    <span style={{ 'backgroundColor': stationInfo.properties.color }}>{stationInfo.properties.line}</span>\n                    {stationInfo.properties.name}\n                  </div>\n                </>\n              }\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Row className=\"help-buttons\">\n              <Col xs={12}>\n                <Button href={'https://mosmetro.ru/mobile/podat-zayavku-na-soprovozhdenie/'} target=\"_blank\">Помощь маломобильным гражданам</Button>\n              </Col>\n              <Col xs={12}>\n                <Button href={'https://mosmetro.ru/info/zabytye-veshchi/'} target=\"_blank\">Потерял вещь</Button>\n              </Col>\n            </Row>\n            <Chart data={this.props.wifiData} />\n            <EntersMap\n              stationInfo={stationInfo}\n            />\n          </Modal.Body>\n        </Modal>\n    );\n  }\n}\n\n\n\nexport default FullModal;","import React from \"react\";\nimport _ from \"lodash\";\nimport { Modal, Row, Col, Form, Button } from 'react-bootstrap';\n\n\nclass FormInclusive extends React.Component {\n  constructor(props) {\n    super(props);\n    this.props = props;\n  }\n\n  render() {\n    return (\n        <Modal\n          className={\"modal-full\"}\n          show={this.props.show}\n          onHide={() => this.props.setShow(false)}\n          size={this.props.size || \"lg\"}\n          aria-labelledby=\"contained-modal-title-vcenter\"\n          centered\n        >\n          <Modal.Header closeButton>\n            <Modal.Title id=\"contained-modal-title-vcenter\">\n              Оказание помощи маломобильным гражданам\n            </Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Form>\n              <Form.Row>\n                <Form.Group as={Col} controlId=\"formGridEmail\">\n                  <Form.Label>Email</Form.Label>\n                  <Form.Control type=\"email\" placeholder=\"Enter email\" />\n                </Form.Group>\n\n                <Form.Group as={Col} controlId=\"formGridPassword\">\n                  <Form.Label>Password</Form.Label>\n                  <Form.Control type=\"password\" placeholder=\"Password\" />\n                </Form.Group>\n              </Form.Row>\n\n              <Form.Group controlId=\"formGridAddress1\">\n                <Form.Label>Address</Form.Label>\n                <Form.Control placeholder=\"1234 Main St\" />\n              </Form.Group>\n\n              <Form.Group controlId=\"formGridAddress2\">\n                <Form.Label>Address 2</Form.Label>\n                <Form.Control placeholder=\"Apartment, studio, or floor\" />\n              </Form.Group>\n\n              <Form.Row>\n                <Form.Group as={Col} controlId=\"formGridCity\">\n                  <Form.Label>City</Form.Label>\n                  <Form.Control />\n                </Form.Group>\n\n                <Form.Group as={Col} controlId=\"formGridState\">\n                  <Form.Label>State</Form.Label>\n                  <Form.Control as=\"select\" defaultValue=\"Choose...\">\n                    <option>Choose...</option>\n                    <option>...</option>\n                  </Form.Control>\n                </Form.Group>\n\n                <Form.Group as={Col} controlId=\"formGridZip\">\n                  <Form.Label>Zip</Form.Label>\n                  <Form.Control />\n                </Form.Group>\n              </Form.Row>\n\n              <Form.Group id=\"formGridCheckbox\">\n                <Form.Check type=\"checkbox\" label=\"Check me out\" />\n              </Form.Group>\n\n              <Button variant=\"primary\" type=\"submit\">\n                Submit\n              </Button>\n            </Form>\n          </Modal.Body>\n        </Modal>\n    );\n  }\n}\n\n\n\nexport default FormInclusive;","import React from \"react\";\nimport _ from \"lodash\";\nimport { Modal, Row, Col, Form } from 'react-bootstrap';\nimport switchIcon from \"./images/switch.png\";\n\nclass SearchBox extends React.Component {\n  constructor(props) {\n    super(props);\n    this.props = props;\n  }\n\n  render() {\n    return (\n        <div id=\"searchbox\">\n          <Row>\n            <Col className=\"search-header\">\n              <h5>Выберите станции на карте</h5>\n            </Col>\n          </Row>\n          <Row className=\"searchbox-inner\">\n            <Col xs={6}>\n              <Form.Group className=\"searchbox-input searchbox-input_left\" controlId=\"searchForm.from\">\n                <Form.Control type=\"text\" placeholder=\"Откуда\" value={this.props.selectedStation1 ? this.props.selectedStation1.properties.name : \"\"} readOnly />\n              </Form.Group>\n            </Col>\n            <Col xs={6}>\n              <Form.Group className=\"searchbox-input searchbox-input_right\" controlId=\"searchForm.where\">\n                <Form.Control type=\"text\" placeholder=\"Куда\" value={this.props.selectedStation2 ? this.props.selectedStation2.properties.name : \"\"} readOnly />\n              </Form.Group>\n            </Col>\n          </Row>\n          <div className=\"switch-button\" onClick={() => {\n            const temp1 = this.props.selectedStation1 ? Object.assign(this.props.selectedStation1) : null;\n            const temp2 = this.props.selectedStation2 ? Object.assign(this.props.selectedStation2) : null;\n            this.props.setSelectedStation1(temp2);\n            this.props.setSelectedStation2(temp1);\n          }}>\n            <img src={switchIcon} />\n          </div>\n        </div>\n    );\n  }\n}\n\n\n\nexport default SearchBox;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAB2AAAAdgB+lymcgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAEBSURBVHic7dhBCsIwEEbhh6dT3HShuNDTt95CoS5sUWtBkZBpzPsgWzvza80kIEmSJEmSCrEBumE1wbWE6IB+WBfgEFtOfs8BVBlCw73pqkPY8R7CFThFFpWbIZAhhC1wnjyghHUh0RY5/cctaXWfmlv9FEk5+hQfMk5d0d9m2CuwdHvm/wSPkUXlYvNU2nz1o/BiDkMNj3P5JuNzF3EcPvD6M/w4dCQ0bs0tQVvdtPl+KKYKc807dEQWlYvNU2nzc0NHCSvZ1lziSfDrnenf7wOSKPUVaIF1qhC8fcUQAEMAKh+FR3Mh5DwNLsI0hGpOg8/GC5GWvBcikiRJkiTpdzfUoaKT2ksCuQAAAABJRU5ErkJggg==\"","import './App.css';\nimport React, { useRef, useState, useEffect } from \"react\";\nimport MapBox from \"./components/MapBox/MapBox\";\nimport StationInfo from \"./components/StationInfo/StationInfo\";\nimport RouteInfo from \"./components/RouteInfo/RouteInfo\";\nimport FullModal from \"./components/FullModal/FullModal\";\nimport FormInclusive from \"./components/FormInclusive/FormInclusive\";\nimport SearchBox from \"./components/SearchBox/SearchBox\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport $ from 'jquery';\nimport turf from \"turf\";\nimport _ from 'lodash';\nimport PouchDB from 'pouchdb';\nimport \"@turf/line-overlap\";\nvar explode = require('turf-explode');\n\n\nlet localDB = null;\nlet remoteDB = null;\n\nfunction App() {\n  const [showStationInfo, setShowStationInfo] = useState(false);\n  const [showFullModal, setShowFullModal] = useState(false);\n  const [pathData, setPathData] = useState(turf.featureCollection([]));\n  const [selectedStation1, setSelectedStation1] = useState(null);\n  const [selectedStation2, setSelectedStation2] = useState(null);\n  const [stationsData, setStationsData] = useState(turf.featureCollection([]));\n  const [linesData, setLinesData] = useState(turf.featureCollection([]));\n  const [dbSyncStatus, setDBSyncStatus] = useState(false);\n  const [isDataLoading, getIsDataLoading] = useState(false);\n  const [pathStations, setPathStations] = useState(turf.featureCollection([]));\n  const [wifiData, setWifiData] = useState(null);\n  const [riverData, setRiverData] = useState(turf.featureCollection([]));\n  const [boundaryData, setBoundaryData] = useState(turf.featureCollection([]));\n  const [airportPointsData, setAirportPointsData] = useState(turf.featureCollection([]));\n  const [airportLinesData, setAirportLinesData] = useState(turf.featureCollection([]));\n  const [metroPointsData, setMetroPointsData] = useState(turf.featureCollection([]));\n  const [airportData, setAirportData] = useState(turf.featureCollection([]));\n  const [showInclusiveForm, setShowInclusiveForm] = useState(false);\n\n  const getDataFromLocalDB = () => {\n    localDB.get('GeoPoints').then(function (data) {\n      setStationsData(turf.featureCollection(_.map(data.geo, (feature) => {\n        return turf.feature(feature.geometry, { ...feature, geometry: null });\n      })));\n    });\n\n    localDB.get('GeoLines').then(function (data) {\n      setLinesData(turf.featureCollection(_.map(data.geo, (feature) => {\n        return turf.feature(feature.geometry, { ...feature, geometry: null });\n      })));\n    });\n\n    localDB.get('WifiStats').then(function (data) {\n      setWifiData(data.wifi);\n    });\n\n    localDB.get('metro_river').then(function (data) {\n      setRiverData(data.geo);\n    });\n\n    localDB.get('metro_prigorod').then(function (data) {\n      setBoundaryData(data.geo);\n    });\n\n    localDB.get('metro_to_airoprt_line').then(function (data) {\n      setAirportLinesData(data.geo);\n    });\n\n    localDB.get('metro_to_airport_point').then(function (data) {\n      setAirportPointsData(data.geo);\n    });\n\n    localDB.get('metro_end_point').then(function (data) {\n      setMetroPointsData(data.geo);\n    });\n\n    localDB.get('metro_airport').then(function (data) {\n      setAirportData(data.geo);\n    });\n  }\n\n\n  if(!isDataLoading){\n    if(dbSyncStatus === false && dbSyncStatus !== 'error'){\n      localDB = new PouchDB('test3');\n      remoteDB = new PouchDB('http://admin:crz73Bv4@20.67.108.207:5984/test3');\n\n      localDB.replicate.from(remoteDB, function(err, response) {\n        if (err) {\n            setDBSyncStatus('error');\n            console.log(err);\n        } else {\n            setDBSyncStatus(true);\n        }\n      });\n    }\n\n    if(localDB){\n      localDB.info()\n      .then(() => {\n        getDataFromLocalDB();\n      })\n      .catch(e => {\n        console.log('db empty');\n      });\n    }\n\n    getIsDataLoading(true);\n  }\n\n  useEffect(() => {\n    if(dbSyncStatus === true){\n      getDataFromLocalDB();\n    }\n  },\n  [dbSyncStatus]);\n  \n\n  useEffect(() => {\n    if(showFullModal){\n      $('body').removeClass('fix-scroll');\n    } else {\n      $('body').addClass('fix-scroll');\n    }\n  },\n  [showFullModal]);\n\n  useEffect(() => {\n    if(selectedStation1 && selectedStation2 && linesData) {\n      var PathFinder = require('geojson-path-finder');\n      var pathF = new PathFinder(linesData, {\n        precision: 1e-3\n      });\n      var path = pathF.findPath(selectedStation1, selectedStation2);\n      \n      const lineOverlap = require('@turf/line-overlap').default;\n      var a = _.filter(linesData.features, function(data) {\n        return lineOverlap(turf.lineString(path.path), turf.lineString(data.geometry.coordinates), {tolerance: 0.0001}).features.length >= 1;\n      });\n\n      var filteredPathStations = _.filter(stationsData.features, function(data) {\n        return lineOverlap(turf.buffer(data, 0.0001, 'kilometers'), turf.lineString(path.path), {tolerance: 0.0001}).features.length >= 1;\n      });\n\n      setPathStations(turf.featureCollection(filteredPathStations));\n\n      setPathData(turf.featureCollection(a));\n    }\n\n  },\n  [selectedStation1, selectedStation2]);\n\n  useEffect(() => {\n    if(showStationInfo){\n      $('body').addClass('fix-scroll');\n    } else {\n      $('body').removeClass('fix-scroll');\n    }\n  },\n  [showStationInfo]);\n\n  return (\n    <div className=\"App\">\n      <MapBox\n        setShowStationInfo={setShowStationInfo}\n        stationsData={stationsData}\n        linesData={linesData}\n        pathData={pathData}\n        selectedStation1={selectedStation1}\n        selectedStation2={selectedStation2}\n        setSelectedStation1={setSelectedStation1}\n        setSelectedStation2={setSelectedStation2}\n        pathStations={pathStations}\n        riverData={riverData}\n        boundaryData={boundaryData}\n        airportPointsData={airportPointsData}\n        airportLinesData={airportLinesData}\n        metroPointsData={metroPointsData}\n        airportData={airportData}\n      />\n      <SearchBox\n        selectedStation1={selectedStation1}\n        selectedStation2={selectedStation2}\n        setSelectedStation1={setSelectedStation1}\n        setSelectedStation2={setSelectedStation2}\n      />\n      <StationInfo\n        className={\"modal-small modal-bottom\"}\n        stationInfo={showStationInfo}\n        setShow={setShowStationInfo}\n        setShowFullModal={setShowFullModal}\n        setSelectedStation1={setSelectedStation1}\n        setSelectedStation2={setSelectedStation2}\n      />\n      <RouteInfo\n        className={\"modal-small modal-bottom\"}\n        pathData={pathData}\n        setPathData={setPathData}\n        selectedStation1={selectedStation1}\n        selectedStation2={selectedStation2}\n      />\n      <FullModal\n        show={showFullModal}\n        setShow={setShowFullModal}\n        stationInfo={showStationInfo}\n        wifiData={wifiData}\n        setShowInclusiveForm={setShowInclusiveForm}\n      />\n      <FormInclusive\n        show={showInclusiveForm}\n        setShow={setShowInclusiveForm}\n      />\n    </div>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}